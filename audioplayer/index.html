<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Audio Player</title>
  <style>
    /* Basic styling for the audio player */
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      text-align: center;
    }
    audio {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <!-- Audio Player -->
  <audio id="audioPlayer" controls preload="auto" crossorigin="anonymous">
    <!-- The source element will be updated via JavaScript -->
    <source src="" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <script>
    // Function to load audio URL from a JSON file based on the "audioId" query parameter
    function loadAudioFromJSON() {
      // Get the URL parameter "audioId"
      const params = new URLSearchParams(window.location.search);
      const audioId = params.get('audioId');

      // Determine the JSON file to load; if none provided, you can set a default (e.g., "default.json")
      const jsonFile = audioId ? `${audioId}.json` : 'default.json';

      // Fetch the JSON file from the same directory
      fetch(jsonFile)
        .then(response => {
          if (!response.ok) {
            throw new Error(`Network error: ${response.statusText}`);
          }
          return response.json();
        })
        .then(data => {
          if (data.url) {
            // Update the <source> element with the URL from the JSON file
            const audioElement = document.getElementById('audioPlayer');
            const sourceElement = audioElement.querySelector('source');
            sourceElement.src = data.url;
            audioElement.load();  // Reload the audio element with the new source
            console.log(`Loaded audio URL: ${data.url}`);
          } else {
            console.error("JSON file does not contain a 'url' property.");
          }
        })
        .catch(error => {
          console.error("Error fetching or parsing JSON:", error);
        });
    }

    // Load the audio source when the page loads
    loadAudioFromJSON();
  </script>
</body>
</html>
